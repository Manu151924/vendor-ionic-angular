
<ion-button class="today-btn" fill="solid" color="success" (click)="openCalendar()">
      {{ displayDate }}
    <ion-icon name="calendar" slot="end"></ion-icon>
</ion-button>
<div class="trip-report-card">
  <div class="header-row">
    <div class="card-title">
      <ion-icon name="car-outline"></ion-icon>
      Trip Status
    </div>
    <div class="trip-count green">{{ tripStatusRows.length }}</div>
    <div class="absent-title">
      <ion-icon name="car-outline"></ion-icon>
      Absent
    </div>
    <div class="absent-count red">{{ absentRows.length }}</div>
   
  </div>
  <div class="status-section">
    <table class="trip-table">
      <thead>
        <tr>
          <th>VEH No.</th>
          <th>MF vs ULD (WB)</th>
          <th>MF vs ULD (Pkgs.)</th>
          <th>SH/EX</th>
        </tr>
      </thead>
      <tbody>
        @for(ts of tripStatusRows; track ts){
          <tr [class.unloaded]="ts.notUnloaded">
          <td>{{ ts.vehicle.slice(-4) }}</td>
          <td>
            <span [ngClass]="getAmberClass(ts.mfVsUldWB, ts.mfManifestWB)">
              {{ ts.mfVsUldWB }}
            </span>/{{ ts.mfManifestWB }}
          </td>
          <td>
            <span [ngClass]="getAmberClass(ts.mfVsUldPkgs, ts.mfManifestPkgs)">
              {{ ts.mfVsUldPkgs }}
            </span>/{{ ts.mfManifestPkgs }}
          </td>
          <td>
            <span [class.red]="ts.shEx>0" (click)="openShExModal(selectedVehicle)">{{ ts.shEx>0 ? ts.shEx : '-' }}</span>
          </td>
        </tr>
        }
      </tbody>
    </table>
    <table class="absent-table">
      <thead>
        <tr>
          <th>VEH No.</th>
          <th>Last Pickup Date</th>
        </tr>
      </thead>
      <tbody>
        @for(ab of absentRows; track ab){
         <tr>
          <td>{{ ab.vehicleNo }}</td>
          <td>{{ ab.lastPickup }}</td>
        </tr>

        }

      </tbody>
    </table>
  </div>
</div>
  <ion-modal [isOpen]="calendarOpen">
  <ng-template>
    <ion-content>
      <div class="calendar-container">
        <mat-calendar
          [selected]="tempSelectedDate"
          [minDate]="minDate"
          [maxDate]="maxDate"
          (selectedChange)="onDateSelect($event)">
        </mat-calendar>
      </div>
    </ion-content>

    <ion-footer>
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-button (click)="cancelDate()">Cancel</ion-button>
        </ion-buttons>
        <ion-buttons slot="end">
          <ion-button (click)="confirmDate()">OK</ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-footer>
  </ng-template>
</ion-modal>
